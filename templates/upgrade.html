<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Branch Upgrade Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script>
    // Validate application number
    function validateAppNumber(input) {
      const pattern = /^(131|128|127)\d{9}$/;
      const submitBtn = document.getElementById('submitBtn');
      const error = document.getElementById('appError');

      if (!pattern.test(input.value)) {
        error.textContent = "Invalid Application Number. It must start with 131, 128, or 127 and be 12 digits.";
        submitBtn.disabled = true;
      } else {
        error.textContent = "";
        submitBtn.disabled = false;
      }
    }

    // Disable new branch same as previous
    function disableSameBranch() {
      const prev = document.getElementById('prev_branch');
      const next = document.getElementById('new_branch');

      const allOptions = next.options;
      for (let i = 0; i < allOptions.length; i++) {
        allOptions[i].disabled = false;
        if (allOptions[i].value === prev.value) {
          allOptions[i].disabled = true;
        }
      }
    }
  </script>
</head>
<body class="bg-gray-100 text-gray-900">

  <div class="max-w-2xl mx-auto mt-10 bg-white p-8 rounded-lg shadow-md">
    <h2 class="text-2xl font-bold text-blue-800 mb-6 text-center">üîÅ Branch Upgrade Form</h2>

    <form action="/upgrade" method="POST" enctype="multipart/form-data" class="space-y-6">
      <!-- Application Number -->
      <div>
        <label for="application_number" class="block font-medium mb-1">GGSIPU Application Number</label>
        <input type="text" name="application_number" id="application_number" oninput="validateAppNumber(this)" required maxlength="12" pattern="^(131|128|127)[0-9]{9}$"
          class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <p id="appError" class="text-red-600 text-sm mt-1"></p>
      </div>

      <!-- Date of Birth -->
      <div>
        <label for="dob" class="block font-medium mb-1">Date of Birth</label>
        <input type="date" name="dob" id="dob" required
          class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <!-- Previous Branch -->
      <div>
        <label for="prev_branch" class="block font-medium mb-1">Previous Branch</label>
        <select name="prev_branch" id="prev_branch" onchange="disableSameBranch()" required
          class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="" disabled selected>-- Select Previous Branch --</option>
          <option value="AI-DS">AI-DS</option>
          <option value="AI-ML">AI-ML</option>
          <option value="IIOT">IIOT</option>
          <option value="A&R">A&R</option>
        </select>
      </div>

      <!-- New Branch -->
      <div>
        <label for="new_branch" class="block font-medium mb-1">New Upgraded Branch</label>
        <select name="new_branch" id="new_branch" required
          class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="" disabled selected>-- Select New Branch --</option>
          <option value="AI-DS">AI-DS</option>
          <option value="AI-ML">AI-ML</option>
          <option value="IIOT">IIOT</option>
          <option value="A&R">A&R</option>
        </select>
      </div>

      <!-- Upload Reporting Slip -->
      <div>
        <label for="reporting_slip" class="block font-medium mb-1">Upload New Reporting Slip (PDF / Image)</label>
        <input type="file" name="reporting_slip" id="reporting_slip" accept=".pdf" required
          class="w-full border border-gray-300 rounded px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <!-- Submit -->
      <div class="text-center">
        <button type="submit" id="submitBtn"
          class="bg-blue-700 text-white font-semibold px-6 py-2 rounded hover:bg-blue-800 transition">Submit Upgrade Request</button>
      </div>
    </form>
  </div>

</body>
</html>
